<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chocoman√≠a ¬∑ B-01 Registro</title>
  <meta name="description" content="Registro de clientes Chocoman√≠a. HTML5 + Grid + Flex + Box Model. Validaci√≥n de RUT y contrase√±a.">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --gap:16px; --radius:14px; --shadow:0 8px 24px rgba(0,0,0,.08);
      --bg:#f6f7fb; --card:#ffffff; --ink:#1f2937; --muted:#6b7280; --brand:#7d3c98; --brand-2:#a66cc4;
      --ok:#10b981; --warn:#f59e0b; --err:#ef4444; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.45;
    }
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1140px; margin:0 auto; padding:20px}

    /* Header */
    header.top{
      position:sticky; top:0; z-index:30; backdrop-filter:saturate(180%) blur(8px);
      background:rgba(246,247,251,.8); border-bottom:1px solid var(--border);
    }
    .topbar{display:flex; align-items:center; justify-content:space-between; gap:12px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:700; font-size:1.15rem}
    .brand .logo{width:36px; height:36px; border-radius:10px; background:linear-gradient(135deg,#522a7a,#aa6bc8); box-shadow:inset 0 0 0 2px rgba(255,255,255,.25)}
    nav ul{display:flex; gap:14px; list-style:none; margin:0; padding:0}
    nav a{padding:8px 12px; border-radius:999px}
    nav a:hover{background:#ece7f6}
    .cta{display:flex; gap:10px}
    .btn{border:1px solid var(--border); background:#fff; border-radius:999px; padding:10px 14px; cursor:pointer}
    .btn.primary{background:var(--brand); color:#fff; border-color:transparent}
    .btn.ghost{background:transparent}

    /* Hero */
    .hero{display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; align-items:center; margin-top:18px}
    .hero .panel{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); padding:22px}
    .hero h1{margin:0 0 6px 0; font-size:clamp(1.35rem, 2.2vw, 2rem)}
    .hero p{margin:6px 0 0 0; color:var(--muted)}
    .hero-visual{border-radius:var(--radius); position:relative; overflow:hidden; display:grid; place-items:center}
    .hero-visual::before{
      content:''; position:absolute; inset:0; background:
        radial-gradient(1200px 400px at 10% 0%, rgba(125,60,152,.18), transparent 60%),
        radial-gradient(900px 300px at 100% 90%, rgba(166,108,196,.15), transparent 60%),
        linear-gradient(120deg, rgba(255,255,255,.85), rgba(255,255,255,.6));
    }
    .hero-visual .img-slot{
      width:86%;
      aspect-ratio: 1 / 1;             
      border-radius:18px;
      overflow:hidden;                  
      background:#fff;
      box-shadow: var(--shadow);
      display:grid; place-items:center;
      position:relative;
      border:2px solid #f0e9f8;         
    }
    .hero-visual .img-slot img{
      width:100%; height:100%;
      object-fit:cover; object-position:center;  
      display:block; border-radius:inherit;
    }
    .chip{display:inline-flex; gap:8px; align-items:center; font-size:.8rem; color:#6a5a75; background:#f3eafc; border:1px dashed #d2b9eb; padding:6px 10px; border-radius:999px}

    /* Main grid */
    .grid{display:grid; grid-template-columns: 1.05fr .95fr; gap:20px; margin-top:20px}
    @media (max-width: 900px){ .hero{grid-template-columns:1fr} .grid{grid-template-columns:1fr} }

    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px; box-shadow:var(--shadow)}
    .card h2{margin:0 0 8px 0}
    .muted{color:var(--muted)}

    /* Form */
    form.form{display:flex; flex-direction:column; gap:14px}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .field{flex:1 1 220px; display:flex; flex-direction:column; gap:6px}
    .label{font-weight:600; font-size:.95rem}
    .control{display:flex; align-items:center; gap:8px}
    input,select{width:100%; padding:12px 12px; border:1px solid #d1d5db; border-radius:10px; background:#fafafa; outline:none}
    input:focus{border-color:#b48ad3; box-shadow:0 0 0 4px rgba(125,60,152,.12)}
    .hint{font-size:.85rem; color:var(--muted)}
    .error{font-size:.85rem; color:var(--err); display:none}
    .showpass{border:1px solid #d1d5db; background:#fff; border-radius:10px; padding:10px 12px; cursor:pointer}
    .terms{display:flex; gap:10px; align-items:flex-start}

    .actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn[disabled]{opacity:.6; cursor:not-allowed}

    /* Password strength */
    .meter{height:8px; background:#eef2ff; border-radius:999px; overflow:hidden; border:1px solid #e5e7eb}
    .meter > i{display:block; height:100%; width:0%; transition:width .35s ease}
    .weak{background:var(--err)} .mid{background:var(--warn)} .strong{background:var(--ok)}

    /* Estados (escenarios) */
    .estados{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:14px}
    .estado{border:1px dashed #c7b5d9; padding:14px; border-radius:12px; background:#fdfbff}

    /* Toast */
    .toast-wrap{position:fixed; top:18px; right:18px; display:grid; gap:10px; z-index:50}
    .toast{background:#111827; color:#fff; padding:12px 14px; border-radius:12px; box-shadow:var(--shadow); opacity:0; transform:translateY(-10px); transition:.25s}
    .toast.show{opacity:1; transform:translateY(0)}

    /* Footer */
    footer{margin:40px 0 20px; color:var(--muted); text-align:center}
  </style>
</head>
<body>
  <header class="top">
    <div class="container topbar">
      <div class="brand"><div class="logo" aria-hidden="true"></div> Chocoman√≠a</div>
      <nav aria-label="principal">
        <ul>
          <li><a href="#catalogo" aria-label="Ver cat√°logo">Cat√°logo</a></li>
          <li><a href="#ofertas">Ofertas</a></li>
          <li><a href="#carrito">Carrito</a></li>
          <li><a href="#ingresar">Ingresar</a></li>
        </ul>
      </nav>
      <div class="cta">
        <button class="btn ghost" type="button">Ayuda</button>
        <button class="btn primary" type="button">Ver promociones</button>
      </div>
    </div>
  </header>

  <div class="container hero">
    <div class="panel">
      <h1>Crea tu cuenta y disfruta de <em>env√≠o dulce</em> üéÅ</h1>
      <p class="muted">Valida tu correo, protege tu cuenta con una contrase√±a segura y empieza a comprar chocolates artesanales con ofertas exclusivas.</p>
    </div>
    <div class="hero-visual panel" aria-label="Espacio para banner/promoci√≥n">
      <div class="img-slot">
        <img src="IMG/baner.png" alt="Chocolates artesanales" loading="lazy" decoding="async">
      </div>
    </div>
  </div>

  <main class="container grid" id="registro">
    <!-- Columna izquierda: Formulario real -->
    <section class="card" aria-labelledby="t-form">
      <h2 id="t-form">Formulario de registro</h2>
      <p class="muted" style="margin-top:0">Campos obligatorios marcados con * ¬∑ Tus datos est√°n protegidos</p>

      <form class="form" id="formRegistro" novalidate>
        <div class="row">
          <div class="field">
            <label class="label" for="nombre">Nombre completo *</label>
            <input id="nombre" name="nombre" autocomplete="name" required placeholder="Juanita P√©rez" />
            <span class="error" data-error-for="nombre">Ingresa tu nombre.</span>
          </div>
          <div class="field">
            <label class="label" for="email">Correo electr√≥nico *</label>
            <input id="email" name="email" type="email" autocomplete="email" required placeholder="juanita@example.com" />
            <span class="error" data-error-for="email">Ingresa un correo v√°lido.</span>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label class="label" for="rut">RUT (Chile) *</label>
            <input id="rut" name="rut" inputmode="text" placeholder="12.345.678-5" required />
            <span class="hint">Formato: sin o con puntos y guion. Se valida d√≠gito verificador.</span>
            <span class="error" data-error-for="rut">RUT inv√°lido.</span>
          </div>
          <div class="field">
            <label class="label" for="telefono">Tel√©fono</label>
            <input id="telefono" name="telefono" type="tel" autocomplete="tel" placeholder="+56 9 1234 5678" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label class="label" for="pass">Contrase√±a *</label>
            <div class="control">
              <input id="pass" name="pass" type="password" autocomplete="new-password" required placeholder="********" aria-describedby="hintPass meterLabel" />
              <button class="showpass" type="button" id="togglePass" aria-label="Mostrar u ocultar contrase√±a">üëÅ</button>
            </div>
            <div class="meter" aria-hidden="true" title="fortaleza">
              <i id="meterBar"></i>
            </div>
            <div id="meterLabel" class="hint">Al menos 8 caracteres, 1 may√∫scula y 1 d√≠gito.</div>
            <span class="error" data-error-for="pass">La contrase√±a no cumple los requisitos.</span>
          </div>
          <div class="field">
            <label class="label" for="pass2">Confirmar contrase√±a *</label>
            <input id="pass2" name="pass2" type="password" autocomplete="new-password" required placeholder="********" />
            <span class="error" data-error-for="pass2">Las contrase√±as no coinciden.</span>
          </div>
        </div>

        <label class="terms">
          <input type="checkbox" id="terminos" required />
          <span>Acepto los <a href="#">T√©rminos y Condiciones</a> y la <a href="#">Pol√≠tica de Privacidad</a>.</span>
        </label>
        <span class="error" data-error-for="terminos">Debes aceptar los t√©rminos para continuar.</span>

        <div class="actions">
          <button class="btn primary" id="btnSubmit" type="submit">Crear cuenta</button>
          <button class="btn" type="reset">Limpiar</button>
          <span class="hint">¬øYa tienes cuenta? <a href="#ingresar">Inicia sesi√≥n</a>.</span>
        </div>
      </form>
    </section>

    <!-- Columna derecha: Estados/Mensajes -->
    <aside class="card" aria-labelledby="t-estados">
      <h2 id="t-estados">Estados del registro</h2>
      <div class="estados">
        <div class="estado">
          <h3>Verificaci√≥n de correo</h3>
          <p>Te enviamos un correo para verificar tu cuenta. Rev√≠salo y vuelve a esta p√°gina.</p>
          <button class="btn" type="button" id="simVerificado">Marcar como verificado</button>
        </div>
        <div class="estado">
          <h3>Verificaci√≥n expirada</h3>
          <p>El enlace de verificaci√≥n expir√≥. Solicita uno nuevo para continuar.</p>
          <button class="btn" type="button" id="simReenviar">Reenviar enlace</button>
        </div>
        <div class="estado">
          <h3>Registro ya existente</h3>
          <p>Detectamos un correo o RUT ya registrados. Intenta iniciar sesi√≥n o recuperar tu contrase√±a.</p>
          <button class="btn" type="button" id="simExistente">Ir a ingresar</button>
        </div>
      </div>
    </aside>
  </main>

  <div class="toast-wrap" aria-live="polite" aria-atomic="true"></div>

  <footer>
    <div class="container">¬© <span id="year"></span> Chocoman√≠a ¬∑ Hecho con mucho cacao üç´</div>
  </footer>

  <script>
    // Utilidad: normalizar y validar RUT chileno (m√≥dulo 11)
    function limpiarRut(rut){ return rut.replace(/\.|\s|-/g,'').toUpperCase(); }
    function dvRut(num){ let s=1, m=0; for(; num; num=Math.floor(num/10)) s=(s+num%10*(9-m++%6))%11; return s? String(s-1):'K'; }
    function validarRut(rut){
      const r = limpiarRut(rut); if(!/^\d{7,8}[0-9K]$/.test(r)) return false;
      const cuerpo = r.slice(0,-1), dv = r.slice(-1); return dvRut(parseInt(cuerpo,10)) === dv;
    }

    // Fortaleza de contrase√±a b√°sica
    function fuerza(pass){
      let score = 0;
      if(pass.length >= 8) score++;
      if(/[A-Z]/.test(pass)) score++;
      if(/[0-9]/.test(pass)) score++;
      if(/[^A-Za-z0-9]/.test(pass)) score++;
      return score; // 0..4
    }

    const form = document.getElementById('formRegistro');
    const meterBar = document.getElementById('meterBar');
    const pass = document.getElementById('pass');
    const pass2 = document.getElementById('pass2');
    const rut = document.getElementById('rut');
    const btnSubmit = document.getElementById('btnSubmit');
    const toastWrap = document.querySelector('.toast-wrap');

    document.getElementById('togglePass').addEventListener('click', ()=>{
      pass.type = pass.type === 'password' ? 'text' : 'password';
    });

    pass.addEventListener('input', ()=>{
      const s = fuerza(pass.value);
      const pct = [0, 25, 50, 75, 100][s];
      meterBar.style.width = pct + '%';
      meterBar.className = s <= 1 ? 'weak' : (s === 2 ? 'mid' : 'strong');
    });

    function showError(name, show=true){
      const el = document.querySelector(`[data-error-for="${name}"]`);
      if(el) el.style.display = show ? 'block' : 'none';
    }

    function toast(msg, type='ok'){
      const t = document.createElement('div');
      t.className = 'toast';
      t.innerHTML = msg;
      if(type==='err'){ t.style.background = '#991b1b'; }
      if(type==='warn'){ t.style.background = '#92400e'; }
      if(type==='ok'){ t.style.background = '#065f46'; }
      toastWrap.appendChild(t);
      requestAnimationFrame(()=> t.classList.add('show'));
      setTimeout(()=>{ t.classList.remove('show'); setTimeout(()=>t.remove(), 200); }, 3400);
    }

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      ['nombre','email','rut','pass','pass2','terminos'].forEach(n=>showError(n,false));

      let ok = true;
      const nombre = form.nombre.value.trim();
      const email = form.email.value.trim();
      const rutVal = form.rut.value.trim();
      const p1 = form.pass.value; const p2 = form.pass2.value;
      const term = document.getElementById('terminos').checked;

      if(!nombre){ showError('nombre',true); ok=false; }
      if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)){ showError('email',true); ok=false; }
      if(!validarRut(rutVal)){ showError('rut',true); ok=false; }
      if(fuerza(p1) < 2){ showError('pass',true); ok=false; }
      if(p1 !== p2){ showError('pass2',true); ok=false; }
      if(!term){ showError('terminos',true); ok=false; }

      if(!ok) { toast('Revisa los campos marcados.', 'warn'); return; }

      btnSubmit.disabled = true; btnSubmit.textContent = 'Creando cuenta‚Ä¶';
      await new Promise(r=>setTimeout(r, 1300));

      const scenarios = ['ok','existente','expirada'];
      const pick = scenarios[Math.floor(Math.random()*scenarios.length)];

      if(pick==='ok'){ toast('Cuenta creada. Te enviamos un correo para verificarla. ‚úÖ','ok'); }
      if(pick==='existente'){ toast('Este correo o RUT ya se encuentra registrado.','warn'); }
      if(pick==='expirada'){ toast('El enlace de verificaci√≥n anterior expir√≥. Reenviamos uno nuevo.','warn'); }

      btnSubmit.disabled = false; btnSubmit.textContent = 'Crear cuenta';
    });

    document.getElementById('simVerificado').addEventListener('click', ()=> toast('Correo verificado. ¬°Bienvenido/a! üéâ','ok'));
    document.getElementById('simReenviar').addEventListener('click', ()=> toast('Hemos reenviado el enlace de verificaci√≥n.','ok'));
    document.getElementById('simExistente').addEventListener('click', ()=> toast('Redirigiendo a Ingresar‚Ä¶','warn'));

    rut.addEventListener('blur', ()=>{
      const r = limpiarRut(rut.value);
      if(/^(\d{7,8})([0-9K])$/.test(r)){
        const cuerpo = r.slice(0,-1).replace(/(\d)(?=(\d{3})+(?!\d))/g,'$1.');
        rut.value = cuerpo + '-' + r.slice(-1);
      }
    });

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
